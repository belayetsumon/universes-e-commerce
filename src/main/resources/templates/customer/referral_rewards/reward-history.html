<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
    <head>
        <title>Reward History</title>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
    </head>
    <body>
        <div class="container mt-4">
            <h2>Reward History</h2>

            <form method="get" class="row g-3 mb-3">
                <div class="col-md-3">
                    <label>Start Date</label>
                    <input type="date" name="startDate" class="form-control" th:value="${startDate}" />
                </div>
                <div class="col-md-3">
                    <label>End Date</label>
                    <input type="date" name="endDate" class="form-control" th:value="${endDate}" />
                </div>
                <div class="col-md-4">
                    <label>Type</label>
                    <select multiple name="types" class="form-select">
                        <option th:each="type : ${types}" th:value="${type}" th:text="${type}" th:selected="${selectedTypes.contains(type)}"></option>
                    </select>
                </div>
                <div class="col-md-2 d-flex align-items-end">
                    <button class="btn btn-primary w-100" type="submit">Filter</button>
                </div>
            </form>

            <table class="table table-striped">
                <thead>
                    <tr>
                        <th>Date</th>
                        <th>Type</th>
                        <th>Description</th>
                        <th>Amount</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody>
                    <tr th:each="txn : ${transactions.content}">
                        <td th:text="${#dates.format(txn.createdAt, 'yyyy-MM-dd HH:mm')}"></td>
                        <td th:text="${txn.type}"></td>
                        <td th:text="${txn.description}"></td>
                        <td th:text="${txn.amount}"></td>
                        <td th:text="${txn.redeemed ? 'Redeemed/Expired' : 'Active'}"></td>
                    </tr>
                </tbody>
            </table>

            <nav th:if="${transactions.totalPages > 1}">
                <ul class="pagination">
                    <li th:classappend="${transactions.first}? 'disabled'">
                        <a th:href="@{/rewards(page=${transactions.number - 1}, startDate=${startDate}, endDate=${endDate}, types=${selectedTypes})}" class="page-link">Previous</a>
                    </li>
                    <li th:each="i : ${#numbers.sequence(0, transactions.totalPages -1)}" th:classappend="${i == transactions.number} ? 'active'">
                        <a th:href="@{/rewards(page=${i}, startDate=${startDate}, endDate=${endDate}, types=${selectedTypes})}" class="page-link" th:text="${i + 1}"></a>
                    </li>
                    <li th:classappend="${transactions.last}? 'disabled'">
                        <a th:href="@{/rewards(page=${transactions.number + 1}, startDate=${startDate}, endDate=${endDate}, types=${selectedTypes})}" class="page-link">Next</a>
                    </li>
                </ul>
            </nav>
        </div>
    </body>
</html>
